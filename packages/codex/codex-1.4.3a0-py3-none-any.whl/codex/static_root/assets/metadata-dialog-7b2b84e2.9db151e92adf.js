import{c as z,o as c,e as V,aF as Ie,r as ne,w as T,aG as Ne,aH as X,ay as Xe,M as oe,c7 as Ze,c8 as Qe,bS as h,c9 as _e,U as ce,ca as A,cb as ye,ai as ue,cc as Je,cd as et,ce as Me,O as Re,R as me,cf as tt,ah as Fe,cg as at,W as ve,ch as W,ci as lt,g as l,bh as ke,bi as st,cj as rt,bk as nt,ck as ot,cl as it,cm as Se,cn as ut,bO as dt,bg as ct,co as mt,bU as Ce,F as he,bV as vt,av as se,I as ht,E as ft,cp as pt,a as ee,L as Z,d as I,cq as bt,as as fe,f as R,t as P,cr as gt,i as d,cs as _t,ct as yt,x as kt,C as Le,j as O,D as re,aC as St,p as Ae,q as Ee,H as Ct,cu as wt,_ as $e,bI as Tt,cv as Vt,A as Bt,B as Pt,b9 as It,bK as Nt,b7 as Mt,b8 as Rt,cw as Ft,N as we,b as Te,J as Lt,b2 as At,b5 as Et,k as $t,aX as Dt,aD as Ot}from"./admin-bb49fdd9.js";const zt={name:"PaginationToolbar"};function jt(e,t,a,n,o,s){return c(),V(Xe,{class:"paginationToolbar codexToolbar",density:"compact",transform:"center bottom"},Ie({_:2},[ne(e.$slots,(i,r)=>({name:r,fn:T(f=>[Ne(e.$slots,r,X({props:i},f),void 0,!0)])}))]),1024)}const hl=z(zt,[["render",jt],["__scopeId","data-v-cfa8cce0"]]);const pe=Symbol.for("vuetify:v-slider");function Ut(e,t,a){const n=a==="vertical",o=t.getBoundingClientRect(),s="touches"in e?e.touches[0]:e;return n?s.clientY-(o.top+o.height/2):s.clientX-(o.left+o.width/2)}function xt(e,t){return"touches"in e&&e.touches.length?e.touches[0][t]:"changedTouches"in e&&e.changedTouches.length?e.changedTouches[0][t]:e[t]}const qt=oe({disabled:{type:Boolean,default:null},error:Boolean,readonly:{type:Boolean,default:null},max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:e=>["vertical","horizontal"].includes(e)},reverse:Boolean,...Ze(),...Qe({elevation:2})},"Slider"),Gt=e=>{const t=h(()=>parseFloat(e.min)),a=h(()=>parseFloat(e.max)),n=h(()=>+e.step>0?parseFloat(e.step):0),o=h(()=>Math.max(_e(n.value),_e(t.value)));function s(i){if(n.value<=0)return i;const r=Me(i,t.value,a.value),f=t.value%n.value,m=Math.round((r-f)/n.value)*n.value+f;return parseFloat(Math.min(m,a.value).toFixed(o.value))}return{min:t,max:a,step:n,decimals:o,roundValue:s}},Kt=e=>{let{props:t,steps:a,onSliderStart:n,onSliderMove:o,onSliderEnd:s,getActiveThumb:i}=e;const{isRtl:r}=ce(),f=A(t,"reverse"),m=h(()=>{let u=r.value?"rtl":"ltr";return t.reverse&&(u=u==="rtl"?"ltr":"rtl"),u}),{min:g,max:S,step:_,decimals:F,roundValue:E}=a,j=h(()=>parseInt(t.thumbSize,10)),Y=h(()=>parseInt(t.tickSize,10)),U=h(()=>parseInt(t.trackSize,10)),L=h(()=>(S.value-g.value)/_.value),x=A(t,"disabled"),q=h(()=>t.direction==="vertical"),$=h(()=>t.error||t.disabled?void 0:t.thumbColor??t.color),p=h(()=>t.error||t.disabled?void 0:t.trackColor??t.color),N=h(()=>t.error||t.disabled?void 0:t.trackFillColor??t.color),M=ye(!1),y=ye(0),B=ue(),C=ue();function v(u){var ge;const b=t.direction==="vertical",qe=b?"top":"left",Ge=b?"height":"width",Ke=b?"clientY":"clientX",{[qe]:Ye,[Ge]:He}=(ge=B.value)==null?void 0:ge.$el.getBoundingClientRect(),We=xt(u,Ke);let ie=Math.min(Math.max((We-Ye-y.value)/He,0),1)||0;return(b||m.value==="rtl")&&(ie=1-ie),E(g.value+ie*(S.value-g.value))}const Q=u=>{s({value:v(u)}),M.value=!1,y.value=0},J=u=>{C.value=i(u),C.value&&(C.value.focus(),M.value=!0,C.value.contains(u.target)?y.value=Ut(u,C.value,t.direction):(y.value=0,o({value:v(u)})),n({value:v(u)}))},G={passive:!0,capture:!0};function D(u){o({value:v(u)})}function k(u){u.stopPropagation(),u.preventDefault(),Q(u),window.removeEventListener("mousemove",D,G),window.removeEventListener("mouseup",k)}function w(u){var b;Q(u),window.removeEventListener("touchmove",D,G),(b=u.target)==null||b.removeEventListener("touchend",w)}function K(u){var b;J(u),window.addEventListener("touchmove",D,G),(b=u.target)==null||b.addEventListener("touchend",w,{passive:!1})}function te(u){u.preventDefault(),J(u),window.addEventListener("mousemove",D,G),window.addEventListener("mouseup",k,{passive:!1})}const H=u=>{const b=(u-g.value)/(S.value-g.value)*100;return Me(isNaN(b)?0:b,0,100)},ae=A(t,"showTicks"),le=h(()=>ae.value?t.ticks?Array.isArray(t.ticks)?t.ticks.map(u=>({value:u,position:H(u),label:u.toString()})):Object.keys(t.ticks).map(u=>({value:parseFloat(u),position:H(parseFloat(u)),label:t.ticks[u]})):L.value!==1/0?Je(L.value+1).map(u=>{const b=g.value+u*_.value;return{value:b,position:H(b)}}):[]:[]),xe=h(()=>le.value.some(u=>{let{label:b}=u;return!!b})),be={activeThumbRef:C,color:A(t,"color"),decimals:F,disabled:x,direction:A(t,"direction"),elevation:A(t,"elevation"),hasLabels:xe,horizontalDirection:m,isReversed:f,min:g,max:S,mousePressed:M,numTicks:L,onSliderMousedown:te,onSliderTouchstart:K,parsedTicks:le,parseMouseMove:v,position:H,readonly:A(t,"readonly"),rounded:A(t,"rounded"),roundValue:E,showTicks:ae,startOffset:y,step:_,thumbSize:j,thumbColor:$,thumbLabel:A(t,"thumbLabel"),ticks:A(t,"ticks"),tickSize:Y,trackColor:p,trackContainerRef:B,trackFillColor:N,trackSize:U,vertical:q};return et(pe,be),be},Yt=oe({focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0},ripple:{type:[Boolean,Object],default:!0},...Re()},"VSliderThumb"),Ht=me()({name:"VSliderThumb",directives:{Ripple:tt},props:Yt(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a,emit:n}=t;const o=Fe(pe),{rtlClasses:s}=ce();if(!o)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:i,step:r,vertical:f,disabled:m,thumbSize:g,thumbLabel:S,direction:_,readonly:F,elevation:E,isReversed:j,horizontalDirection:Y,mousePressed:U,decimals:L}=o,{textColorClasses:x,textColorStyles:q}=at(i),{pageup:$,pagedown:p,end:N,home:M,left:y,right:B,down:C,up:v}=ot,Q=[$,p,N,M,y,B,C,v],J=h(()=>r.value?[1,2,3]:[1,5,10]);function G(k,w){if(!Q.includes(k.key))return;k.preventDefault();const K=r.value||.1,te=(e.max-e.min)/K;if([y,B,C,v].includes(k.key)){const ae=(Y.value==="rtl"?[y,v]:[B,v]).includes(k.key)?1:-1,le=k.shiftKey?2:k.ctrlKey?1:0;w=w+ae*K*J.value[le]}else if(k.key===M)w=e.min;else if(k.key===N)w=e.max;else{const H=k.key===p?1:-1;w=w-H*K*(te>100?te/10:10)}return Math.max(e.min,Math.min(e.max,w))}function D(k){const w=G(k,e.modelValue);w!=null&&n("update:modelValue",w)}return ve(()=>{const k=W(f.value||j.value?100-e.position:e.position,"%"),{elevationClasses:w}=lt(h(()=>m.value?void 0:E.value));return l("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":e.focused,"v-slider-thumb--pressed":e.focused&&U.value},e.class,s.value],style:[{"--v-slider-thumb-position":k,"--v-slider-thumb-size":W(g.value)},e.style],role:"slider",tabindex:m.value?-1:0,"aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.modelValue,"aria-readonly":!!F.value,"aria-orientation":_.value,onKeydown:F.value?void 0:D},[l("div",{class:["v-slider-thumb__surface",x.value,w.value],style:{...q.value}},null),ke(l("div",{class:["v-slider-thumb__ripple",x.value],style:q.value},null),[[st("ripple"),e.ripple,null,{circle:!0,center:!0}]]),l(rt,{origin:"bottom center"},{default:()=>{var K;return[ke(l("div",{class:"v-slider-thumb__label-container"},[l("div",{class:["v-slider-thumb__label"]},[l("div",null,[((K=a["thumb-label"])==null?void 0:K.call(a,{modelValue:e.modelValue}))??e.modelValue.toFixed(r.value?L.value:1)])])]),[[nt,S.value&&e.focused||S.value==="always"]])]}})])}),{}}});const Wt=oe({start:{type:Number,required:!0},stop:{type:Number,required:!0},...Re()},"VSliderTrack"),Xt=me()({name:"VSliderTrack",props:Wt(),emits:{},setup(e,t){let{slots:a}=t;const n=Fe(pe);if(!n)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:o,horizontalDirection:s,parsedTicks:i,rounded:r,showTicks:f,tickSize:m,trackColor:g,trackFillColor:S,trackSize:_,vertical:F,min:E,max:j}=n,{roundedClasses:Y}=it(r),{backgroundColorClasses:U,backgroundColorStyles:L}=Se(S),{backgroundColorClasses:x,backgroundColorStyles:q}=Se(g),$=h(()=>`inset-${F.value?"block-end":"inline-start"}`),p=h(()=>F.value?"height":"width"),N=h(()=>({[$.value]:"0%",[p.value]:"100%"})),M=h(()=>e.stop-e.start),y=h(()=>({[$.value]:W(e.start,"%"),[p.value]:W(M.value,"%")})),B=h(()=>f.value?(F.value?i.value.slice().reverse():i.value).map((v,Q)=>{var D;const J=F.value?"bottom":"margin-inline-start",G=v.value!==E.value&&v.value!==j.value?W(v.position,"%"):void 0;return l("div",{key:v.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":v.position>=e.start&&v.position<=e.stop,"v-slider-track__tick--first":v.value===E.value,"v-slider-track__tick--last":v.value===j.value}],style:{[J]:G}},[(v.label||a["tick-label"])&&l("div",{class:"v-slider-track__tick-label"},[((D=a["tick-label"])==null?void 0:D.call(a,{tick:v,index:Q}))??v.label])])}):[]);return ve(()=>l("div",{class:["v-slider-track",Y.value,e.class],style:[{"--v-slider-track-size":W(_.value),"--v-slider-tick-size":W(m.value),direction:F.value?void 0:s.value},e.style]},[l("div",{class:["v-slider-track__background",x.value,{"v-slider-track__background--opacity":!!o.value||!S.value}],style:{...N.value,...q.value}},null),l("div",{class:["v-slider-track__fill",U.value],style:{...y.value,...L.value}},null),f.value&&l("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":f.value==="always"}]},[B.value])])),{}}}),Zt=oe({...ut(),...qt(),...dt(),modelValue:{type:[Number,String],default:0}},"VSlider"),Qt=me()({name:"VSlider",props:Zt(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,start:e=>!0,end:e=>!0},setup(e,t){let{slots:a,emit:n}=t;const o=ue(),{rtlClasses:s}=ce(),i=Gt(e),r=ct(e,"modelValue",void 0,p=>{const N=typeof p=="string"?parseFloat(p):p??i.min.value;return i.roundValue(N)}),{min:f,max:m,mousePressed:g,roundValue:S,onSliderMousedown:_,onSliderTouchstart:F,trackContainerRef:E,position:j,hasLabels:Y,readonly:U}=Kt({props:e,steps:i,onSliderStart:()=>{n("start",r.value)},onSliderEnd:p=>{let{value:N}=p;const M=S(N);r.value=M,n("end",M)},onSliderMove:p=>{let{value:N}=p;return r.value=S(N)},getActiveThumb:()=>{var p;return(p=o.value)==null?void 0:p.$el}}),{isFocused:L,focus:x,blur:q}=mt(e),$=h(()=>j(r.value));return ve(()=>{const[p,N]=Ce.filterProps(e),M=!!(e.label||a.label||a.prepend);return l(Ce,X({class:["v-slider",{"v-slider--has-labels":!!a["tick-label"]||Y.value,"v-slider--focused":L.value,"v-slider--pressed":g.value,"v-slider--disabled":e.disabled},s.value,e.class],style:e.style},p,{focused:L.value}),{...a,prepend:M?y=>{var B,C;return l(he,null,[((B=a.label)==null?void 0:B.call(a,y))??e.label?l(vt,{id:y.id.value,class:"v-slider__label",text:e.label},null):void 0,(C=a.prepend)==null?void 0:C.call(a,y)])}:void 0,default:y=>{let{id:B,messagesId:C}=y;return l("div",{class:"v-slider__container",onMousedown:U.value?void 0:_,onTouchstartPassive:U.value?void 0:F},[l("input",{id:B.value,name:e.name||B.value,disabled:!!e.disabled,readonly:!!e.readonly,tabindex:"-1",value:r.value},null),l(Xt,{ref:E,start:0,stop:$.value},{"tick-label":a["tick-label"]}),l(Ht,{ref:o,"aria-describedby":C.value,focused:L.value,min:f.value,max:m.value,modelValue:r.value,"onUpdate:modelValue":v=>r.value=v,position:$.value,elevation:e.elevation,onFocus:x,onBlur:q},{"thumb-label":a["thumb-label"]})])}})}),{}}}),Jt={name:"PaginationSlider"};function ea(e,t,a,n,o,s){return c(),V(Qt,X({"thumb-size":"36",class:"paginationSlider",density:"compact","hide-details":"auto",rounded:!0,"show-ticks":"always",step:1,"thumb-label":"always"},e.$attrs),null,16)}const fl=z(Jt,[["render",ea],["__scopeId","data-v-825b160e"]]);const ta={name:"PaginationNavButton"};function aa(e,t,a,n,o,s){return c(),V(se,X({class:"paginationNavButton",height:"100%"},e.$attrs),Ie({_:2},[ne(e.$slots,(i,r)=>({name:r,fn:T(f=>[Ne(e.$slots,r,X({props:i},f),void 0,!0)])}))]),1040)}const pl=z(ta,[["render",aa],["__scopeId","data-v-852fad11"]]),de=ht.browser.vuetifyNullCode,la=".None.",Ve={value:de,title:la},sa=new Set(["",de,de.toString(),void 0]),ra=function(e,t){let a;return e===void 0?a=e:e instanceof Object?(a={value:e.pk,title:e.name},sa.has(a.value)||!a.title?a=Ve:t||(a.value=+e.pk)):e===null?a=Ve:a={value:e,title:e.toString()},a},na=function(e,t){return e.title<t.title?-1:e.title>t.title?1:0},oa=function(e,t){return Number.parseFloat(e.title)-Number.parseFloat(t.title)},ia=function(e,t,a=!1,n=!1){const o=e||[],s=t&&t.toLowerCase();let i=[];for(const f of o){const m=ra(f,n);m&&(!s||m.title&&m.title.toLowerCase().includes(s))&&i.push(m)}const r=a?oa:na;return i.sort(r)};const ua={name:"PlaceholderLoading",props:{indeterminate:{type:Boolean,default:!0}}};function da(e,t,a,n,o,s){return c(),V(ft,X({"aria-label":"loading",class:"codexProgressCircular",indeterminate:a.indeterminate},e.$attrs),null,16,["indeterminate"])}const De=z(ua,[["render",da],["__scopeId","data-v-7bb4cf22"]]),ca=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],ma=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],va=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],ha=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],Be=(e,t,a)=>{let n=e;return typeof t=="string"||Array.isArray(t)?n=e.toLocaleString(t,a):(t===!0||a!==void 0)&&(n=e.toLocaleString(void 0,a)),n};function fa(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);t={bits:!1,binary:!1,space:!0,...t};const a=t.bits?t.binary?ha:va:t.binary?ma:ca,n=t.space?" ":"";if(t.signed&&e===0)return` 0${n}${a[0]}`;const o=e<0,s=o?"-":t.signed?"+":"";o&&(e=-e);let i;if(t.minimumFractionDigits!==void 0&&(i={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(i={maximumFractionDigits:t.maximumFractionDigits,...i}),e<1){const g=Be(e,t.locale,i);return s+g+n+a[0]}const r=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),a.length-1);e/=(t.binary?1024:1e3)**r,i||(e=e.toPrecision(3));const f=Be(Number(e),t.locale,i),m=a[r];return s+f+n+m}const pa=(e,t)=>e?`${pt(e)}/cover.webp?${t}`:window.CODEX.MISSING_COVER;const ba={name:"BookCover",props:{group:{type:String,required:!0},childCount:{type:Number,default:1},finished:{type:Boolean},coverPk:{type:Number,required:!0}},data(){return{showPlaceholder:!1}},computed:{...ee(Z,{coverSrc:function(e){return pa(this.coverPk,e.page.coversTimestamp)}})},mounted:function(){this.delayPlaceholder()},methods:{delayPlaceholder:function(){setTimeout(()=>{this.showPlaceholder=!0},2e3)}}},ga={class:"bookCover"},_a={key:1,class:"childCount"};function ya(e,t,a,n,o,s){return c(),I("div",ga,[l(bt,{src:e.coverSrc,class:"coverImg"},null,8,["src"]),a.finished!==!0?(c(),I("div",{key:0,class:fe({unreadFlag:!0,mixedreadFlag:a.finished===null})},null,2)):R("",!0),a.group!=="c"?(c(),I("span",_a,P(a.childCount),1)):R("",!0)])}const Oe=z(ba,[["render",ya],["__scopeId","data-v-9acb5f6a"]]);const ka={name:"MetadataTags",props:{label:{type:String,required:!0},items:{type:Array,default(){return[]}},values:{type:Array,default(){return[]}}},data(){return{mdiFilter:gt}},computed:{...ee(Z,{filterValues:function(e){return e.settings.filters[this.label.toLowerCase()]}}),model(){return ia(this.values)}},methods:{chipColor:function(e){return this.filterValues&&this.filterValues.includes(e)?this.$vuetify.theme.current.colors["primary-darken-1"]:""}}},Sa={key:0,class:"tags"},Ca={class:"label"};function wa(e,t,a,n,o,s){return s.model&&s.model.length>0?(c(),I("div",Sa,[l(yt,{value:s.model,multiple:"",class:"chipGroup"},{default:T(()=>[d("div",Ca,P(a.label),1),(c(!0),I(he,null,ne(s.model,i=>(c(),V(_t,{key:`${a.label}/${i.value}`,color:s.chipColor(i.value),value:i.value,text:i.title},null,8,["color","value","text"]))),128))]),_:1},8,["value"])])):R("",!0)}const ze=z(ka,[["render",wa],["__scopeId","data-v-80903885"]]);const Ta={name:"MetadataTextBox",props:{label:{type:String,required:!0},value:{type:[Object,String,Number,Boolean],default:void 0},link:{type:Boolean,default:!1},group:{type:String,default:""},obj:{type:Object,default:void 0}},data(){return{mdiOpenInNew:kt}},computed:{computedValue(){return this.value!=null&&this.value instanceof Object?this.value.name:this.value},highlight(){var e;return((e=this.obj)==null?void 0:e.group)===this.group},pathArray(){if(this.computedValue)return this.computedValue.split("/")},folderPath(){if(this.pathArray)return this.pathArray.slice(0,-1).join("/")},basePath(){if(this.pathArray)return this.pathArray.at(-1)},groupTo(){const e=Z();if(this.group!=="f"&&!e.settings.show[this.group]||this.group==="f"&&!e.page.adminFlags.folderView)return;let t;if(t=this.obj&&this.obj.group==this.group?this.obj.pk:this.value.pk,!t)return;const a=this.$router.currentRoute.value.params;if(!(a.group===this.group&&+a.pk===t))return{name:"browser",params:{group:this.group,pk:t}}}}},Va={class:"textLabel"},Ba={class:"textValue"},Pa=["href"],Ia={key:3,class:"textContent"},Na={key:4,id:"basePath"};function Ma(e,t,a,n,o,s){const i=Le("router-link");return s.computedValue?(c(),I("div",{key:0,class:fe(["text",{highlight:s.highlight}])},[d("div",Va,P(a.label),1),d("div",Ba,[s.groupTo&&a.group==="f"?(c(),V(i,{key:0,id:"folderPath",to:s.groupTo,title:"Browse Folder"},{default:T(()=>[O(P(s.folderPath)+"/",1)]),_:1},8,["to"])):s.groupTo?(c(),V(i,{key:1,class:"textContent",to:s.groupTo,title:`Browse ${a.label}`},{default:T(()=>[O(P(s.computedValue),1)]),_:1},8,["to","title"])):a.link?(c(),I("a",{key:2,href:s.computedValue,target:"_blank"},[O(P(s.computedValue)+" ",1),l(re,{size:"small"},{default:T(()=>[O(P(o.mdiOpenInNew),1)]),_:1})],8,Pa)):(c(),I("div",Ia,P(s.computedValue),1)),s.groupTo&&a.group==="f"?(c(),I("span",Na,P(s.basePath),1)):R("",!0)])],2)):R("",!0)}const je=z(Ta,[["render",Ma],["__scopeId","data-v-7a19eb52"]]);const Ra={name:"MetadatacreatorsTable",props:{value:{type:Array,default:void 0}},data(){return{}},computed:{sortedcreators:function(){return this.value?[...this.value].sort(this.creatorsCompare):[]},...ee(Z,{filteredCreators(e){return e.settings.filters.creators}})},methods:{roleName:function(e){return e==="CoverArtist"?"Cover Artist":e},creatorSortable:function(e){const t=e.person.name.split(" ");let a=[];return t&&(a.push(t.slice(-1)),t.length>1&&a.push(t.slice(0,-1))),a.push(e.role.name),a.join(" ")},creatorsCompare:function(e,t){const a=this.creatorSortable(e),n=this.creatorSortable(t);return a<n?-1:a>n?1:0},isFilteredCreator(e){return this.filteredCreators&&this.filteredCreators.includes(e)}}},Ue=e=>(Ae("data-v-f650684d"),e=e(),Ee(),e),Fa=Ue(()=>d("h2",null,"Credits",-1)),La={class:"highlight-table"},Aa=Ue(()=>d("thead",null,[d("tr",null,[d("th",{class:"text-left"},"Role"),d("th",{class:"text-left"},"Person")])],-1)),Ea={class:"highlight"};function $a(e,t,a,n,o,s){return s.sortedcreators&&s.sortedcreators.length>0?(c(),V(St,{key:0,id:"creatorsTable"},{default:T(()=>[Fa,d("table",La,[Aa,d("tbody",null,[(c(!0),I(he,null,ne(s.sortedcreators,i=>(c(),I("tr",{key:i.pk},[d("td",null,P(s.roleName(i.role.name)),1),d("td",{class:fe({filteredOn:s.isFilteredCreator(i.person.pk)})},[d("span",Ea,P(i.person.name),1)],2)]))),128))])])]),_:1})):R("",!0)}const Da=z(Ra,[["render",$a],["__scopeId","data-v-f650684d"]]),Oa=({pk:e,page:t,readLtr:a,pageCount:n})=>{if(n){if(t)t=Number(t);else if(a)t=0;else{const o=Number(n)-1;t=Math.max(o,0)}return{name:"reader",params:{pk:e,page:t}}}},Pe=Ct("metadata",{state:()=>({md:void 0}),actions:{async loadMetadata({group:e,pk:t}){const a=Z();await wt.getMetadata({group:e,pk:t},a.settings).then(n=>(this.md=n.data,!0)).catch(n=>{console.error(n),this.clearMetadata()})},clearMetadata(){this.md=void 0}}});const za=1160,ja=.05,Ua=250,xa={name:"MetadataButton",components:{BookCover:Oe,CloseButton:$e,MetadatacreatorsTable:Da,MetadataTags:ze,MetadataText:je,PlaceholderLoading:De},props:{group:{type:String,required:!0},pk:{type:Number,required:!0},children:{type:Number,default:1}},data(){return{mdiDownload:Tt,mdiTagOutline:Vt,dialog:!1,progress:0}},computed:{...Bt(Pt,["isUserAdmin"]),...ee(Z,{twentyFourHourTime:e=>e.settings.twentyFourHourTime}),...ee(Pe,{md:e=>e.md,downloadFileName:e=>{const t=e.md;return e.md.path?t.path.split("/").at(-1):It({seriesName:t.series.name,volumeName:t.volume.name,issue:t.issue,issueSuffix:t.issueSuffix})+"."+globalThis.fileType.toLowerCase()}}),...ee(Z,{q:e=>e.settings.q}),downloadURL:function(){return Nt(this.pk)},isReadButtonShown:function(){return this.group==="c"&&this.$route.name!="reader"},isReadButtonEnabled:function(){return this.$route.name==="browser"&&!!this.readerRoute},readButtonIcon:function(){return this.isReadButtonEnabled?Mt:Rt},readerRoute:function(){return Oa(this.md)},formattedIssue:function(){if(!((this.md.issue===null||this.md.issue===void 0)&&!this.md.issueSuffix))return Ft({issue:this.md.issue,issueSuffix:this.md.issueSuffix})},ltrText:function(){return this.md.readLtr?"Left to Right":"Right to Left"},pages:function(){let e="";if(this.md.page){const a=we.format(this.md.page);e+=`Read ${a} of `}const t=we.format(this.md.pageCount);return e+=`${t} pages`,this.md.progress>0&&(e+=` (${Math.round(this.md.progress)}%)`),e},size:function(){return fa(this.md.size)},fileType:function(){return this.md.fileType||"Unknown"},storyArcs(){const e=[];for(const t of this.md.storyArcs){const a={...t};for(const n of this.md.storyArcNumbers){const o=n.number;if(o!=null&&n.storyArc.pk===a.pk){a.name=a.name+`: ${o}`;break}}e.push(a)}return e}},watch:{dialog:function(e){e?this.dialogOpened():this.clearMetadata()}},methods:{...Te(Pe,["clearMetadata","loadMetadata"]),...Te(Lt,["downloadIOSPWAFix"]),dialogOpened:function(){this.loadMetadata({group:this.group,pk:this.pk}),this.startProgress()},startProgress:function(){this.startTime=Date.now(),this.estimatedMS=Math.max(ja,this.children/za)*1e3,this.updateProgress()},updateProgress:function(){const e=Date.now()-this.startTime;this.progress=e/this.estimatedMS*100,!(this.progress>=100||this.md)&&setTimeout(()=>{this.updateProgress()},Ua)},formatDateTime:function(e){return At(e,this.twentyFourHourTime)},download(){this.downloadIOSPWAFix(this.downloadURL,this.md.filename)}}},qa=e=>(Ae("data-v-5909d2f2"),e=e(),Ee(),e),Ga={id:"metadataHeader"},Ka={id:"metadataBookCoverWrapper"},Ya={class:"headerHalfRow"},Ha={class:"headerQuarterRow"},Wa={class:"mdSection"},Xa={key:0,class:"inlineRow"},Za={id:"metadataBody"},Qa={class:"mdSection"},Ja={class:"thirdRow"},el={class:"mdSection"},tl={class:"quarterRow"},al={class:"lastSmallRow"},ll={class:"halfRow mdSection"},sl={class:"mdSection"},rl={class:"mdSection"},nl={class:"mdSection"},ol={class:"mdSection"},il={id:"footerLinks"},ul={id:"bottomRightButtons"},dl={key:1,id:"placeholderContainer"},cl=qa(()=>d("div",{id:"placeholderTitle"},"Tags Loading",-1));function ml(e,t,a,n,o,s){const i=$e,r=je,f=Oe,m=ze,g=Le("MetadatacreatorsTable"),S=De;return c(),V(Ot,{modelValue:o.dialog,"onUpdate:modelValue":t[5]||(t[5]=_=>o.dialog=_),fullscreen:"",transition:"dialog-bottom-transition"},{activator:T(({props:_})=>[l(se,X({"aria-label":"tags",class:"tagButton cardControlButton",icon:"",title:"Tags",variant:"text"},_,{onClick:t[0]||(t[0]=Et(()=>{},["prevent"]))}),{default:T(()=>[l(re,null,{default:T(()=>[O(P(o.mdiTagOutline),1)]),_:1})]),_:2},1040)]),default:T(()=>[e.md?(c(),I("div",{key:0,id:"metadataContainer",onKeyup:t[3]||(t[3]=Dt(_=>o.dialog=!1,["esc"]))},[d("header",Ga,[l(i,{class:"closeButton",title:"Close Metadata (esc)",size:"x-large",onClick:t[1]||(t[1]=_=>o.dialog=!1)}),e.q?(c(),V(r,{key:0,id:"search",value:e.q,label:"Search Query",highlight:!0},null,8,["value"])):R("",!0),d("div",Ka,[l(f,{id:"bookCover","cover-pk":e.md.coverPk,group:a.group,"child-count":e.md.childCount,finished:e.md.finished},null,8,["cover-pk","group","child-count","finished"]),l($t,{class:"bookCoverProgress","model-value":e.md.progress,rounded:"","background-color":"inherit",height:"2","aria-label":"% read"},null,8,["model-value"])]),d("div",Ya,[l(r,{id:"publisher",value:e.md.publisher,group:"p",label:"Publisher",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),l(r,{id:"imprint",value:e.md.imprint,group:"i",label:"Imprint",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"])]),l(r,{id:"series",value:e.md.series,label:"Series",group:"s",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),d("div",Ha,[l(r,{id:"volume",value:e.md.volume,label:"Volume",group:"v",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),l(r,{value:e.md.seriesVolumeCount,label:"Volume Count"},null,8,["value"]),l(r,{id:"issue",value:s.formattedIssue,label:"Issue",group:"c",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),l(r,{value:e.md.volumeIssueCount,label:"Issue Count"},null,8,["value"])]),d("section",Wa,[l(r,{value:e.md.name,label:"Title"},null,8,["value"]),e.md.year||e.md.month||e.md.day?(c(),I("div",Xa,[l(r,{value:e.md.year,label:"Year",class:"datePicker",type:"number"},null,8,["value"]),l(r,{value:e.md.month,label:"Month",class:"datePicker"},null,8,["value"]),l(r,{value:e.md.day,label:"Day",class:"datePicker"},null,8,["value"])])):R("",!0),l(r,{value:e.md.gtin,label:"GTIN"},null,8,["value"]),l(r,{value:e.md.original_format,label:"Original Format"},null,8,["value"])])]),d("div",Za,[d("section",Qa,[d("div",Ja,[l(r,{value:s.pages,label:"Pages"},null,8,["value"]),l(r,{value:e.md.finished,label:"Finished"},null,8,["value"]),l(r,{value:s.ltrText,label:"Reading Direction"},null,8,["value"])])]),d("section",el,[d("div",tl,[e.md.createdAt?(c(),V(r,{key:0,value:s.formatDateTime(e.md.createdAt),label:"Created at",class:"mtime"},null,8,["value"])):R("",!0),e.md.updatedAt?(c(),V(r,{key:1,value:s.formatDateTime(e.md.updatedAt),label:"Updated at",class:"mtime"},null,8,["value"])):R("",!0),l(r,{value:s.size,label:"Size"},null,8,["value"]),l(r,{value:s.fileType,label:"File Type"},null,8,["value"])]),d("div",al,[l(r,{group:"f",value:{pk:e.md.parentFolderPk,name:e.md.path},label:"Path"},null,8,["value"])])]),d("section",ll,[l(r,{value:e.md.country,label:"Country"},null,8,["value"]),l(r,{value:e.md.language,label:"Language"},null,8,["value"])]),d("section",sl,[l(r,{value:e.md.communityRating,label:"Community Rating"},null,8,["value"]),l(r,{value:e.md.criticalRating,label:"Critical Rating"},null,8,["value"]),l(r,{value:e.md.ageRating,label:"Age Rating"},null,8,["value"])]),d("section",rl,[l(m,{values:e.md.genres,label:"Genres"},null,8,["values"]),l(m,{values:e.md.characters,label:"Characters"},null,8,["values"]),l(m,{values:e.md.teams,label:"Teams"},null,8,["values"]),l(m,{values:e.md.locations,label:"Locations"},null,8,["values"]),l(m,{values:e.md.seriesGroups,label:"Series Groups"},null,8,["values"]),l(m,{values:s.storyArcs,label:"Story Arcs"},null,8,["values"]),l(m,{values:e.md.tags,label:"Tags"},null,8,["values"])]),d("section",nl,[l(r,{value:e.md.web,label:"Web Link",link:!0},null,8,["value"]),l(r,{value:e.md.summary,label:"Summary"},null,8,["value"]),l(r,{value:e.md.comments,label:"Comments"},null,8,["value"]),l(r,{value:e.md.notes,label:"Notes"},null,8,["value"]),l(r,{value:e.md.scanInfo,label:"Scan"},null,8,["value"])]),d("section",ol,[l(g,{value:e.md.creators},null,8,["value"])])]),d("footer",il,[a.group==="c"?(c(),V(se,{key:0,id:"downloadButton",title:"Download Comic Archive",onClick:s.download},{default:T(()=>[a.group==="c"?(c(),V(re,{key:0},{default:T(()=>[O(P(o.mdiDownload),1)]),_:1})):R("",!0),O(" Download ")]),_:1},8,["onClick"])):R("",!0),s.isReadButtonShown?(c(),V(se,{key:1,to:s.readerRoute,title:"Read Comic",disabled:!s.isReadButtonEnabled},{default:T(()=>[l(re,null,{default:T(()=>[O(P(s.readButtonIcon),1)]),_:1}),O(" Read ")]),_:1},8,["to","disabled"])):R("",!0),d("span",ul,[l(i,{class:"closeButton",title:"Close Metadata (esc)",size:"x-large",onClick:t[2]||(t[2]=_=>o.dialog=!1)})])])],32)):(c(),I("div",dl,[l(i,{class:"closeButton",title:"Close Metadata (esc)",onClick:t[4]||(t[4]=_=>o.dialog=!1)}),cl,l(S,{"model-value":o.progress,indeterminate:o.progress>=100,class:"placeholder"},null,8,["model-value","indeterminate"])]))]),_:1},8,["modelValue"])}const bl=z(xa,[["render",ml],["__scopeId","data-v-5909d2f2"]]);export{De as P,pl as _,fl as a,hl as b,bl as c,Oe as d,Oa as g,fa as p,ia as t};
