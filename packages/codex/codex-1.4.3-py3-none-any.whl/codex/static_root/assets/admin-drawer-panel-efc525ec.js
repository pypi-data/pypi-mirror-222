import{_ as A,m as B,a as k,u as m,b as v,s as L,N,c as y,o as a,d as o,e as p,V,f as u,g as n,w as r,h as C,F as T,r as w,i as g,j as d,t as c,k as O,l as h,n as S,p as P,q as M,v as F,x,y as E,z as $,A as j,B as z,C as D,D as b,E as R}from"./admin-b2b56cd6.js";const U={name:"AdminStatusList",components:{CloseButton:A},data(){return{mdiCloseCircleOutline:B}},computed:{...k(m,{librarianStatuses:e=>e.librarianStatuses,show:e=>e.librarianStatuses.length>0})},created(){this.load()},methods:{...v(m,["loadTable","librarianTask"]),showComplete:e=>Number.isInteger(e.complete),indeterminate:e=>!e.preactive&&(!e.total||!Number.isInteger(e.complete)),progress(e){return e.preactive||self.indeterminate?0:100*+e.complete/+e.total},load(){this.loadTable("LibrarianStatus")},clear(){this.librarianTask("librarian_clear_status","")},title(e){return L[e.statusType]},nf(e){return Number.isInteger(e)?N.format(e):"?"}}},q=e=>(P("data-v-af1a8109"),e=e(),M(),e),G={key:0},H=q(()=>g("h4",null,"Librarian Tasks",-1)),J={nav:"",class:"statusItem"},K={class:"statusItemTitle"},Q={key:0,class:"statusItemSubtitle"},W={key:1,class:"statusItemSubtitle"},X={key:0};function Y(e,l,i,I,_,t){const f=A;return a(),o(T,null,[e.show?(a(),p(V,{key:0})):u("",!0),n(S,{onClick:t.load},{default:r(()=>[n(C,null,{default:r(()=>[e.show?(a(),o("div",G,[n(f,{id:"clearButton",title:"Clear Librarian Statuses",size:"small",onClick:t.clear},null,8,["onClick"]),H,(a(!0),o(T,null,w(e.librarianStatuses,s=>(a(),p(C,{key:s.statusType},{default:r(()=>[g("div",J,[g("div",K,[d(c(t.title(s))+" ",1),s.subtitle?(a(),o("div",Q,c(s.subtitle),1)):u("",!0),t.showComplete(s)||Number.isInteger(s.total)?(a(),o("div",W,[t.showComplete(s)?(a(),o("span",X,c(t.nf(s.complete))+" / ",1)):u("",!0),d(" "+c(t.nf(s.total)),1)])):u("",!0)]),n(O,{indeterminate:t.indeterminate(s),"model-value":t.progress(s),bottom:""},null,8,["indeterminate","model-value"])])]),_:2},1024))),128))])):(a(),p(h,{key:1,id:"noTasksRunning"},{default:r(()=>[d(" No librarian tasks running ")]),_:1}))]),_:1})]),_:1},8,["onClick"])],64)}const Z=y(U,[["render",Y],["__scopeId","data-v-af1a8109"]]);const ee={name:"AdminMenu",components:{AdminStatusList:Z},props:{menu:{type:Boolean,default:!0}},data(){return{mdiBookAlert:F,mdiOpenInNew:x,mdiDatabaseClockOutline:E,mdiCogOutline:$}},computed:{...j(z,["isUserAdmin"]),...k(m,["unseenFailedImports"])},methods:{...v(m,["clearFailedImports","librarianTask"])}},te={key:0},ae={key:0};function se(e,l,i,I,_,t){const f=D("AdminStatusList");return e.isUserAdmin?(a(),o("div",te,[n(S,{onClick:l[0]||(l[0]=s=>e.librarianTask("poll"))},{default:r(()=>[n(h,null,{default:r(()=>[n(b,null,{default:r(()=>[d(c(_.mdiDatabaseClockOutline),1)]),_:1}),d("Poll All Libraries")]),_:1})]),_:1}),i.menu?(a(),o("div",ae,[n(S,{to:{name:"admin"}},{default:r(()=>[n(h,null,{default:r(()=>[n(b,null,{default:r(()=>[d(c(_.mdiCogOutline),1)]),_:1}),d("Admin Panel "),e.unseenFailedImports?(a(),p(b,{key:0,id:"failedImportsIcon",title:"New Failed Imports"},{default:r(()=>[d(c(_.mdiBookAlert),1)]),_:1})):u("",!0)]),_:1})]),_:1})])):u("",!0),n(f)])):u("",!0)}const ne=y(ee,[["render",se],["__scopeId","data-v-f179af3f"]]),de=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));const re={name:"AdminSettingsButtonProgress",computed:{...k(m,["librarianStatuses"]),progressEnabled:function(){return this.librarianStatuses.length>0},progress:function(){let e=0,l=0;if(!(!this.librarianStatuses||this.librarianStatuses.length===0)){for(const i of this.librarianStatuses){if(i.total===null||i.total===void 0||i.complete===void 0)return;e+=+i.complete,l+=+i.total}if(!(l<=0))return 100*e/l}}},created(){this.loadTable("LibrarianStatus")},methods:{...v(m,["loadTable"])}};function ie(e,l,i,I,_,t){return t.progressEnabled?(a(),p(R,{key:0,indeterminate:t.progress==null,"model-value":t.progress,class:"progress",size:"36","aria-label":"`Librarian tasks in progress ${Math.round(progress)}%`"},null,8,["indeterminate","model-value"])):u("",!0)}const le=y(re,[["render",ie],["__scopeId","data-v-8db54809"]]),ue=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{de as a,ue as b};
