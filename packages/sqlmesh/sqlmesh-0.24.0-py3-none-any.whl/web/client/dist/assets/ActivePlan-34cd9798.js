import{a7 as b,u as k,Q as r,r as d,j as e,d as w,a3 as A,a8 as i,Y as n,a0 as C,c as S,a1 as E,Z as p,a9 as F}from"./index-8a3a4b1d.js";import{T as l}from"./TasksOverview-265003ec.js";import{k as g}from"./popover-162b4a30.js";import"./pluralize-6658fe30.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./context-21841b51.js";function Q({plan:a}){const x=b(),h=k(t=>t.environment),s=r(t=>t.state),o=r(t=>t.setState),c=r(t=>t.setAction),[y,u]=d.useState(!1);function f(){o(n.Cancelling),c(p.Cancelling),F(x).catch(console.error).finally(()=>{c(p.None),o(n.Cancelled)})}return e.jsx(g,{onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},className:"relative flex px-2",children:()=>e.jsxs(e.Fragment,{children:[e.jsx("span",{className:w("inline-block ml-1 px-2 py-[3px] rounded-[4px] text-xs font-bold cursor-default",N(s)),children:a==null?0:1}),e.jsx(A,{show:y,as:d.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:e.jsx(g.Panel,{className:"absolute right-1 z-10 mt-8 transform",children:e.jsxs("div",{className:"overflow-hidden rounded-lg bg-theme shadow-lg ring-1 ring-black ring-opacity-5",children:[e.jsx(l,{tasks:a.tasks,children:({total:t,completed:v,models:m,completedBatches:j,totalBatches:P})=>e.jsxs(e.Fragment,{children:[e.jsx(l.Summary,{environment:h.name,planState:s,headline:"Most Recent Plan",completed:v,total:t,completedBatches:j,totalBatches:P,updateType:a.type===i.Virtual?"Virtual":"Backfill",updatedAt:a.updated_at}),m!=null&&e.jsx(l.Details,{models:m,showBatches:a.type!==i.Virtual,showVirtualUpdate:a.type===i.Virtual,showProgress:!0})]})}),e.jsx("div",{className:"my-4 px-4",children:s===n.Applying&&e.jsx(C,{size:S.sm,variant:E.Danger,className:"mx-0",onClick:t=>{t.stopPropagation(),f()},children:"Cancel"})})]})})})]})})}function N(a){return a===n.Finished?"bg-success-500 text-light":a===n.Failed?"bg-danger-500 text-light":a===n.Applying?"bg-secondary-500 text-light":"bg-neutral-100 text-neutral-500"}export{Q as default};
