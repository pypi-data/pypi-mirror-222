import{L as H,V as j,s as A}from"./ListviewItem-5151f17f.js";/* empty css                             */import{l as G,a9 as J,e as Z,r as n,c as w,w as x,o as K,b as O,y as v,I as f,j as s,A as u,R as B,N as d,D as g,F,J as L,z as y,H as k,x as Q,k as W,q as X,L as Y,Z as z}from"./index-ebe4cd91.js";import{_ as ee}from"./PanelviewItem.vue_vue_type_style_index_0_lang-516932fb.js";import{e as S}from"./eventbus-d154090d.js";import{V as R}from"./VToolbar-76e5fae8.js";import{V as te}from"./index-bda4e7b4.js";import{V as ae}from"./VTextField-034239e4.js";import{a as le,V as se}from"./VCheckboxBtn-fcc73f36.js";import{V as re,a as oe}from"./VRow-03e92c8f.js";import{V as ie}from"./VSpacer-4a7692ef.js";import{V as ue,q as ne}from"./VImg-b5692565.js";import"./MediaItemThumb.vue_vue_type_style_index_0_lang-bf2386aa.js";import"./ListItem-a20c73ec.js";import"./VMenu-86ca5efe.js";import"./VListItem-0df8c60b.js";import"./VCard-46ebf6a3.js";/* empty css              */const ve={key:2},me={style:{"margin-left":"15px"}},Fe=G({__name:"Search",props:{initSearch:{}},setup(T){const b=T,N=J(),{mobile:P}=Z(),r=n("list"),p=n(0),o=n(""),m=n(!1),l=n(),h=n(!1),_=n(),$=["topresult","artists","albums","tracks","playlists","radios"],D=w(()=>P.value?140:150),E=function(){r.value==="panel"?r.value="list":r.value="panel",localStorage.setItem(`viewMode.search.${i.value}`,r.value)},C=function(e){S.emit("playdialog",{items:[e],showContextMenuItems:!0})},I=function(e){var t;["artist","album","playlist"].includes(e.media_type)||!((t=X.selectedPlayer)!=null&&t.available)?N.push({name:e.media_type,params:{itemId:e.item_id,provider:e.provider}}):S.emit("playdialog",{items:[e],showContextMenuItems:!1})};x(()=>o.value,()=>{clearTimeout(_.value),_.value=setTimeout(()=>{q()},200)});const U=function(e){return e<500?2:e<=500?3:e<=700?4:e<=1e3?5:e<=1200?6:e<=1500?7:e<=1700?8:e>1700?9:0},q=async function(){h.value=!0,localStorage.setItem("globalsearch",o.value),o.value?l.value=await Y.search(o.value):l.value=void 0,h.value=!1},i=w(()=>$[p.value]),V=w(()=>{if(!l.value)return[];if(i.value=="artists")return l.value.artists;if(i.value=="albums")return l.value.albums;if(i.value=="tracks")return l.value.tracks;if(i.value=="playlists")return l.value.playlists;if(i.value=="radios")return l.value.radio;if(i.value=="topresult"){const e=[];for(const t of[l.value.tracks,l.value.artists,l.value.albums,l.value.playlists,l.value.radio]){const a=[];for(const c of t)a.includes(c.provider)||(e.push(c),a.push(c.provider))}return e}return[]});x(()=>i.value,e=>{if(e){const t=localStorage.getItem(`viewMode.search.${i.value}`);t?r.value=t:i.value=="artists"||i.value=="albums"?r.value="panel":r.value="list"}},{immediate:!0}),K(()=>{if(b.initSearch)o.value=b.initSearch;else{const e=localStorage.getItem("globalsearch");e&&e!=="null"&&(o.value=e)}});const M=function(e){!m.value&&e.key=="Backspace"?o.value=o.value.slice(0,-1):!m.value&&e.key.length==1&&(o.value+=e.key)};return document.addEventListener("keydown",M),O(()=>{document.removeEventListener("keydown",M)}),(e,t)=>(v(),f("section",null,[s(R,{variant:"flat",color:"transparent",style:{height:"50px"}},{title:u(()=>[B(d(e.$t("search")),1)]),_:1}),s(te),s(ae,{id:"searchInput",modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=a=>o.value=a),clearable:"","prepend-inner-icon":"mdi-magnify",label:e.$t("type_to_search"),"hide-details":"",variant:"filled",onFocus:t[1]||(t[1]=a=>m.value=!0),onBlur:t[2]||(t[2]=a=>m.value=!1)},null,8,["modelValue","label"]),g("div",null,[s(le,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=a=>p.value=a),column:"",style:{"margin-top":"15px","margin-left":"10px"}},{default:u(()=>[(v(),f(F,null,L($,a=>s(se,{key:a,filter:"",outlined:""},{default:u(()=>[B(d(e.$t(a)),1)]),_:2},1024)),64))]),_:1},8,["modelValue"]),h.value?(v(),y(ne,{key:0,indeterminate:""})):k("",!0),r.value=="panel"?(v(),y(re,{key:1},{default:u(()=>[(v(!0),f(F,null,L(V.value,a=>(v(),y(oe,{key:a.uri,class:z(`col-${U(e.$vuetify.display.width)}`)},{default:u(()=>[s(ee,{item:a,size:D.value,"is-selected":!1,"show-checkboxes":!1,onMenu:C,onClick:I},null,8,["item","size"])]),_:2},1032,["class"]))),128))]),_:1})):k("",!0),r.value=="list"?(v(),f("div",ve,[s(Q(A),{items:V.value,"item-size":60,"key-field":"item_id","page-mode":""},{default:u(({item:a})=>[s(H,{item:a,"show-track-number":!1,"show-duration":!0,"show-library":!1,"show-menu":!0,"show-provider":!0,"show-checkboxes":!1,"is-selected":!1,"show-details":!0,onMenu:C,onClick:I},null,8,["item"])]),_:1},8,["items"])])):k("",!0),s(R,{density:"compact",variant:"flat",color:"transparent",height:"45"},{default:u(()=>[g("span",me,d(e.$t("items_total",[V.value.length])),1),s(ie),s(j,{location:"bottom"},{activator:u(({props:a})=>[s(ue,W(a,{icon:r.value=="panel"?"mdi-view-list":"mdi-grid",variant:"plain",onClick:t[4]||(t[4]=c=>E())}),null,16,["icon"])]),default:u(()=>[g("span",null,d(e.$t("tooltip.toggle_view_mode")),1)]),_:1})]),_:1})])]))}});export{Fe as default};
